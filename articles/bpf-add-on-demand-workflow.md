---
title: オンデマンド ワークフローをビジネス プロセス フローのステージに追加する | Microsoft Docs
description: ビジネス プロセス フローにオンデマンド ワークフローを追加する方法について説明します。
author: MSFTMAN
ms.author: Deonhe
manager: kvivek
ms.date: 07/12/2018
ms.topic: article
ms.service: flow
applies_to:
- Dynamics 365 (online)
- Dynamics 365 Version 9.x
- Power Apps
ms.assetid: 26c79c20-2987-476e-983a-406e0db13034
search.app:
- Flow
search.audienceType:
- flowmaker
- enduser
ms.openlocfilehash: 6b21e8f8a6938544cbe75f237f6bb5352643d4b3
ms.sourcegitcommit: 83e22ff7d539b02573548df5ca2a8bc41ea48227
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2020
ms.locfileid: "4476943"
---
# <a name="add-an-on-demand-workflow-to-a-business-process-flow"></a>業務プロセス フローにオンデマンド ワークフローを追加する

[!INCLUDE[cc-data-platform-banner](./includes/cc-data-platform-banner.md)]


業務プロセス フロー内からオンデマンドでワークフローをトリガーすることができます。 たとえば、ステージが完了するたびにアクティビティ (タスク、電子メールなど) が作成されるように、オンデマンド ワークフローを業務プロセス フローに追加できます。 

ワークフローは、ワークフローを業務プロセス フロー デザイナーにドロップした場所を基に有効化されます。
- オンデマンドのステージ プロセス。 ワークフローが業務プロセス フロー ステージにドロップされると、ステージの開始または終了によってワークフローがトリガーされます。 
- オンデマンドのグローバル プロセス。 ワークフローが **グローバル ワークフロー** エリアにドロップされると、プロセスのアクティブ化またはプロセスのアーカイブで (状態が適用済み、完了済み、再アクティブ化済み、破棄された状態に切り替えられたタイミングで) ワークフローがトリガーされます。 

ワークフローを業務プロセス フローに追加する際は、次の要件に注意してください。
- ステージに追加されたワークフローの場合: ワークフローを追加したステージの同じエンティティに対して作成された、アクティブなオンデマンド ワークフローのみを使用できます。  
- グローバル ワークフローの場合: ビジネス プロセス フローのプライマリ エンティティに対して作成された、アクティブなオンデマンド ワークフローのみを使用できます。

## <a name="add-an-on-demand-workflow-to-a-business-process-flow-stage"></a>オンデマンド ワークフローを業務プロセス フローのステージに追加する

ワークフローのコンポーネントをプロセス ステージまたはグローバル ワークフロー セクションにドラッグすることで、ビジネス プロセス フロー デザイナーからオンデマンド ワークフローを追加します。 

[PowerApps](https://make.powerapps.com)サイトで、**モデル駆動型** (ナビゲーション ウィンドウの左下) を選択します。 

ビジネス プロセス フロー デザイナーを開きます。 2 つの方法のいずれかでこの操作を行うことができます。
- ビジネス プロセス フローが既にアプリに追加されている場合、**…** を選択するアプリの横の **アプリ** に移動し、**編集** を選択します。 アプリ デザイナーでビジネス プロセス フローを選択し、![業務プロセス フロー デザイナーを開く](media/dynamics365-open-designer.PNG) を選択します。  
- それ以外の場合は、[ソリューション エクスプローラー](/powerapps/maker/model-driven-apps/advanced-navigation.md#solution-explorer)を開き、左側のナビゲーション ウィンドウで **プロセス** を選択し、対象とするビジネス プロセス フローを選択します。 

オンデマンド ワークフローを次のビジネス プロセス フロー イベントのいずれかを使用してトリガーするかどうかを決定します。 
- オンデマンドのステージ プロセス。 ステージの開始、またはステージの終了でワークフローをトリガーする。 
- オンデマンドのグローバル プロセス。 プロセスのアクティブ化、またはプロセスのアーカイブ時 (状態が適用、完了、再起動、放棄に遷移した場合) にワークフローをトリガーします。 

以下の例では、**自分のオンデマンド フロー** という名前のオンデマンド ワークフローが、ビジネス プロセス フローの **ステージ 1** に追加されます。 

1. ステージ 1 を展開して、**トリガーされたプロセス** セクションを表示します。 
2. **コンポーネント** タブを選択して、**ワークフロー** を **トリガーされたプロセス** セクションにドラッグします。
    ![ワークフローをステージに追加する](media/add-workflow-to-bpf-1.png) 代わりに、**グローバル ワークフロー** セクションに **ワークフロー** をドラッグすることができます。これにより、プロセスのアクティブ化、またはプロセスのアーカイブ化のいずれかでワークフローがトリガーされます。
 ![ワークフローをプロセスのアクティブ化、またはアーカイブに追加する](media/add-workflow-to-bpf-global.png)
3. **プロパティ** タブの検索ボックスに、ビジネス プロセス フローのステージに追加するオンデマンド ワークフローの名前を入力して検索し、**適用** を選択します。
    ![名前を入力して適用を選択する](media/add-workflow-to-bpf-2.png)
4. **トリガー** 配下の **プロパティ** タブで、**ステージの開始**、または **ステージの終了** のいずれかを選択します。  
    ![ワークフロー トリガーを選択する](media/workflow-trigger.png)
   
    代わりに、ワークフローを **グローバル ワークフロー** セクションにドロップした場合、トリガー オプションは **適用されたプロセス**、**再アクティブ化されたプロセス**、**破棄されたプロセス**、**完了したプロセス** となります。

5. 業務プロセス フロー デザイナーのツール バーで **更新** を選択します。
 
## <a name="next-steps"></a>次の手順
[ワークフロー プロセスを使用してユーザー操作を必要としないプロセスを自動化する](workflow-processes.md) <br/>
[チュートリアル: プロセスを標準化するビジネス プロセス フローの作成](create-business-process-flow.md) <br/>
[Dynamics 365 でビジネス プロセス フローを自動化する](https://blogs.msdn.microsoft.com/crm/2017/03/28/business-process-flow-automation-in-dynamics-365/)
