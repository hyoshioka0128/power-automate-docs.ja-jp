---
title: Power Apps のバックグラウンド ワークフロー ステージとステップを構成する | MicrosoftDocs
description: バックグラウンド ワークフロー ステップの構成方法を説明します
ms.custom: ''
ms.date: 07/27/2020
ms.reviewer: ''
ms.service: flow
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
author: Mattp123
ms.assetid: 0b47dfd5-76db-464f-90c0-c64a0173dcdd
caps.latest.revision: 18
ms.author: matp
manager: kvivek
search.app:
- Flow
search.audienceType:
- flowmaker
- enduser
ms.openlocfilehash: 12a2c0227472c5e3481c1fe7eca52bfe4c4a5bea
ms.sourcegitcommit: 6aead6aa695ef3dd09a397f7e2df85e3f480071f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/11/2020
ms.locfileid: "3795061"
---
# <a name="configure-background-workflow-stages-and-steps"></a>バックグラウンド ワークフローのステージとステップを構成する


ワークフローを設計するとき、ステージおよびステップで実行するロジックを選択して含めることができます。  
  
 **ステージ**  
 ステージは、ワークフロー ロジックを読みやすくし、またワークフロー ロジックを説明します。 ただし、ワークフローのロジックや動作が影響を受けることはありません。 プロセスにステージが存在する場合、プロセス内のすべてのステップをステージに含める必要があります。  
  
 **ステップ**  
 ステップは、ワークフロー内のビジネス ロジックの単位です。 ステップには、条件、アクション、他のステップ、またはこれらの要素の組み合わせを含めることができます。  
  
<a name="BKMK_ActionsWorkflowProcessesCanPerform"></a>  
 
## <a name="actions-that-background-workflow-processes-can-perform"></a>バックグラウンド ワークフロー プロセスで実行できるアクション  

 バックグラウンド ワークフロー プロセスは次の表で示すアクションを実行できます。  
  
|目的|内容|  
|------------|-----------------|  
|**レコードの作成**|エンティティの新しいレコードを作成し、属性に対して選択した値を割り当てます。|  
|**レコードの更新**|バックグラウンド ワークフローを実行するレコード、N:1 の関連付けでそのレコードにリンクされているいずれかのレコード、これまでの手順で作成した任意のレコードを更新できます。|  
|**レコードの割り当て**|バックグラウンド ワークフローが実行されているレコード、N:1 の関連付けのレコードにリンクされているレコード、前のステップで作成した任意のレコードを割り当てできます。|  
|**電子メールの送信**|電子メールを送信します。 新しいメール メッセージを作成するか、バックグラウンド ワークフローが実行されているレコードのエンティティまたはエンティティと N:1 のリレーションシップを持つエンティティに対して構成された電子メール テンプレートを使用するか、または以前のステップで作成されたすべてのレコードのエンティティを使用するかを選択できます。|  
|**子ワークフローの開始**|子ワークフローとして構成されているバックグラウンド ワークフロー プロセスを開始します。|  
|**状態の変更**|プロセスが関わっているレコード、N:1 の関連付けでそのレコードにリンクされているいずれかのレコード、またはこれまでの手順によって作成された任意のレコードの状態を変更します。|  
|**ワークフローの停止**|現在のワークフローを停止します。 **成功**または**取り消し済み**のいずれかの状態を設定し、ステータス メッセージを指定できます。|  
|**カスタム ステップ**|開発者はアクションを定義するバックグラウンド カスタム ワークフロー ステップを作成できます。 既定では、使用できるカスタム ステップはありません。|  
  
### <a name="setting-record-values"></a>レコードの値の設定  

 レコードを作成するとき、レコードの値を設定できます。 レコードを更新するとき、値を設定、追加、増加、減少、乗算、またはクリアすることができます。  
  
 **プロパティの設定**を選択すると、エンティティの既定のフォームを示すダイアログが開きます。  
  
 ダイアログの下部に、フォームに表示されていないそのほかのフィールドの一覧が表示されています。  
  
 どのフィールドについても、ワークフローによって設定される静的な値を設定できます。  
  
 ダイアログの右側にある**フォーム アシスタント**で、現在のレコードのコンテキストから動的な値を設定または追加できます。 これには、エンティティに対する N:1 (多対一) の関連付けからアクセスできる関連レコードの値が含まれます。  
  
 **フォーム アシスタント**で使用できるオプションは、フォームで選択したフィールドによって決まります。 動的値を設定すると、"置換フィールド" と呼ばれる黄色いプレースホルダーが表示され、動的データが含まれる場所が示されます。 この値を削除する場合は、印刷専用を選択して削除します。 テキスト フィールドに対しては、静的データと動的データを組み合わせて使用できます。  
  
 フィールドまたは関連するエンティティに設定する値が指定されていることを知らない動的な値があること。 実際にいくつかのフィールドを設定して、緑色の矢印を使用して、値を設定したり並べ替えたりすることができます。 最初のフィールドにデータが含まれていない場合は、2番目のフィールドが試されます。 フィールドにデータが含まれていない場合は、使用する既定値を指定できます。  
  
<a name="BKMK_SettingConditionsForWorkflowActions"></a>   

## <a name="setting-conditions-for-background-workflow-actions"></a>バックグラウンド ワークフロー アクションの設定条件  

 適用するアクションは条件によって異なります。 バックグラウンド ワークフロー プロセスは条件を設定ためにいくつかの方法を使用し、必要な結果を取得するための分岐ロジックを作成します。 バックグラウンド ワークフロー プロセスが実行する対象のレコード値、N:1 の関連付けでそのレコードにリンクされているいずれかのレコードの値、またはプロセス自体の内部の値をチェックできます  
  
|条件の種類|内容|  
|--------------------|-----------------|  
|**条件の確認**|論理的な "if-\<condition> then" 構文。<br /><br /> バックグラウンド ワークフローを実行するレコード、N:1の関連付けでそのレコードにリンクされているいずれかのレコード、またはこれまでの手順によって作成された任意のレコードの現在値をチェックできます。 これらの値に基づいて、条件が "True" の場合に追加のステップを定義できます。<br /><br /> "if-\<condition> then" 文で使用できる演算子は、**が次の値と等しい**, **が次の値と等しくない**、**が次のデータを含む**、**が次のデータ含まない**、**に属する**、**に属さない**です。 **注:** **に属する**と**に属さない**は、階層演算子です。 これらは、階層型の関連付けが定義されたエンティティでのみ使用できます。 階層関係が定義されていないエンティティに対して、これらの演算子を使用する場合は、「階層関係が定義されていないエンティティに対して階層演算子を使用していることを示すエラー メッセージが表示されます。 (関係を階層としてマークして) エンティティを階層化するか、別の演算子を使用します。”階層関係の詳細については [階層的に関連するデータの定義とクエリ](/powerapps/maker/common-data-service/define-query-hierarchical-data) を参照してください。 表の後に続くスクリーンショットは、**に属する**と**に属さない**の階層演算子を使用するバックグラウンド ワークフロー プロセスの定義の例です。|  
|**条件分岐**|"else-if-then" は論理的な構文であり、エディターではテキスト “さもなければ, if \<condition> then:” を使用します。<br /><br /> 以前に定義したチェック条件を選択し、チェック条件が false を返すときに追加のステップを定義する条件分岐を追加できます。|  
|**既定の操作**|論理的な "else" ステートメント。 エディターはテキスト “Otherwise:” を使用します。<br /><br /> 以前定義した条件、条件分岐、待機状態、または並列待機分岐を選択します。条件要素や分岐要素で定義した基準に適合しないすべてのケースに対して、既定のアクションを使用してステップを定義できます。|  
|**待機状態**|条件によって定義された基準が満たされるまでバックグラウンド ワークフローが一時停止するようにします。 バックグラウンド ワークフローは、待機条件で定義されている基準が満たされると自動的に再開します。|  
|**並列待機分岐**|初期基準が満たされた場合にのみ実行される、対応する一連の追加ステップを使用して、バックグラウンド ワークフローの代替待機条件を定義します。 並列待機分岐を使用して、バックグラウンド ワークフロー ロジックに時間制限を作成できます。 待機条件で定義されている基準が満たされるまでバックグラウンド ワークフローが無期限に待機することを防ぐのに役立ちます。|  
|**カスタム ステップ**|開発者は条件を定義するバックグラウンド カスタム ワークフロー ステップを作成できます。 既定では、使用できるカスタム ステップはありません。|  
  
 次のスクリーンショットには、**に属する**と**に属さない**の演算子を使用するバックグラウンド ワークフロー プロセスの定義の例が含まれています。 この例では、2 つの異なる値引きを 2 つのグループの取引先企業に適用します。 **ステップの追加**では、**条件の確認**を選択して、**に属する**または**に属さない**の演算子を含む **if-then** 条件を指定しました。 最初の **if-then** 条件がアルペン スキー ハウスの取引先企業**に属する**すべての取引先企業に適用されます。 これらの取引先企業は、購入した商品やサービスで 10% の値引きを受けます。 2 番目の **if-then** の条件がアルペン スキー ハウスの取引先企業**に属さない**すべての取引先企業に適用され、これらの取引先企業は 5% の値引きを受けます。 その後、**レコードの更新**を選択して、条件に基づいて実行されるアクションを定義しました。  
  
 ![未満/以上の演算子を使ったワークフロー プロセス](media/wfp-under-not-under.PNG "未満/以上の演算子を使ったワークフロー プロセス")  
  
  
## <a name="next-steps"></a>次の手順  
 [プロセスを通じてカスタム ビジネス ロジックを作成する](./guide-staff-through-common-tasks-processes.md)   
 [ワークフロー プロセスの概要](workflow-processes.md) [バックグラウンド ワークフロー プロセスの監視と管理](monitor-manage-processes.md)   
 [バックグラウンド ワークフロー プロセスのベスト プラクティス](best-practices-workflow-processes.md)
