---
title: 電子メール | Microsoft Docs
description: 電子メール アクションについての参考情報
author: mariosleon
ms.service: flow
ms.topic: article
ms.date: 12/02/2020
ms.author: marleon
ms.reviewer: ''
search.app:
- Flow
search.audienceType:
- flowmaker
- enduser
ms.openlocfilehash: f22744393849a043dd68cd62f854b8ca2472d519
ms.sourcegitcommit: b043b7e8c29afee4f4f25bbf0d5a662d9af9272c
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/09/2020
ms.locfileid: "4711628"
---
# <a name="email"></a>電子メール



imap/smtp のメールの送信、受信、管理を自動化します

|<!-- --> |
|-----|
|[メールを取得](#retrieveemails)|
|[メールを処理](#processemails)|
|[電子メールの送信](#sendemail)|

### <a name="retrieve-emails"></a><a name="retrieveemails"></a> 電子メールの取得
IMAP サーバーからメール メッセージを取得します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|IMAP サーバー|無効|テキスト値||IMAP サーバー アドレス (例: imap.gmail.com)|
|ポート|有効|数値|993|IMAP サーバーに使用するポートです。 一般的に、ポートは 993 です|
|SSL を有効にする|N/A|ブール値|有効|IMAP サーバーとの通信にセキュリティで保護された接続を使うかどうかを指定します|
|ユーザー名|無効|テキスト値||アクセスするメール アカウントのユーザー名|
|パスワード|無効|暗号化された値||アクセスするメール アカウントのパスワード|
|信頼されていない証明書を受け入れます|N/A|ブール値|無効|信頼されていない証明書を受け入れるかどうかを指定します|
|メール フォルダー|無効|テキスト値||メッセージの取得元の IMAP メール フォルダーの名前 ("メールボックス" とも呼ばれます)|
|取得|N/A|すべての電子メール メッセージ、未読の電子メール メッセージのみ、既読の電子メール メッセージのみ|すべてのメール メッセージ|フォルダー内のすべてのメッセージを取得するか、未読のメッセージのみを取得するかを指定します|
|既読としてマーク|N/A|ブール値|有効|取得したメッセージを既読としてマークするか、そのままにするかを指定します|
|"送信元" フィールドに次が含まれる|有効|テキスト値||メッセージを取得する送信者の完全なメールアドレスです。 この属性を空白のままにしておくと、送信者に関係なくすべてのメッセージを取得することができます|
|"送信先" フィールドに次が含まれる|有効|テキスト値||取得するメッセージの受信者の完全な電子メールアドレス (複数の場合はスペースで区切ります) です。 受信者に関係なくすべてのメッセージを取得するには、この属性を空白のままにしてください|
|"件名" に次が含まれる|有効|テキスト値||電子メールの件名内で見つけるためのキー フレーズ。 件名に関係なくすべての電子メールを取得するには、この属性を空白のままにしてください|
|'本文' に次が含まれる|有効|テキスト値||電子メールの本文内で見つけるためのキー フレーズ。 本文に関係なくすべての電子メールを取得するには、この属性を空白のままにしてください|
|添付ファイルを保存します|N/A|添付ファイルを保存する、添付ファイルを保存しない|添付ファイルを保存しません|取得したメールの添付ファイルを保存するかどうかを指定します|
|添付ファイルを次に保存します|無効|フォルダー||添付ファイルを保存するフォルダー|


##### <a name="variables-produced"></a>作成された変数
|引数|型|内容|
|-----|-----|-----|
|RetrievedEmails|電子メール メッセージの一覧|取得して後で処理を行うメール (メール メッセージ オブジェクトの一覧)|


##### <a name="exceptions"></a><a name="retrieveemails_onerror"></a> 例外
|例外|内容|
|-----|-----|
|IMAP サーバーに接続できませんでした|IMAP サーバーへの接続に問題があったことを示します|
|IMAP サーバーを認証できませんでした|指定された IMAP サーバーの認証に問題があることを示します|
|指定されたメール フォルダーが存在しません|指定されたメール フォルダーが見つからなかったことを示します|
|添付ファイルを保存できませんでした|添付ファイルを保存するときに問題が発生したことを示します|
|メールを取得できませんでした|メールの取得中に問題が発生したことを示します|

### <a name="process-emails"></a><a name="processemails"></a>プロセスの電子メール
メールの取得アクションにより取得されたメール (またはメールの一覧) を移動、削除、または未読としてマークします

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|IMAP サーバー|無効|テキスト値||IMAP サーバー アドレス (例: imap.gmail.com)|
|ポート|有効|数値|993|IMAP サーバーに使用するポートです。 一般的に、ポートは 993 です|
|SSL を有効にする|N/A|ブール値|有効|IMAP サーバーとの通信にセキュリティで保護された接続を使うかどうかを指定します|
|ユーザー名|無効|テキスト値||アクセスするメール アカウントのユーザー名|
|パスワード|無効|暗号化された値||アクセスするメール アカウントのパスワード|
|信頼されていない証明書を受け入れます|N/A|ブール値|無効|信頼されていない証明書を受け入れるかどうかを指定します|
|処理するメール|無効|電子メール メッセージの一覧||処理する電子メール、またはそのリストです。 これは、メールを取得するアクションによって生成された変数である必要があります|
|操作|N/A|サーバーから電子メールを削除する、電子メールを未読としてマークする、電子メール フォルダに移動する、電子メールを未読としてマークして電子メール フォルダに移動する|メールをメール フォルダーに移動|指定されたメール メッセージに対して実行する操作|
|メール フォルダー|無効|テキスト値||メールの移動先となるメール フォルダーの名前|


##### <a name="variables-produced"></a>作成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="processemails_onerror"></a> 例外
|例外|内容|
|-----|-----|
|IMAP サーバーに接続できませんでした|IMAP サーバーへの接続に問題があったことを示します|
|指定されたメール フォルダーが存在しません|指定されたメール フォルダーが見つからなかったことを示します|
|メールを処理できませんでした|指定されたメールの処理中に問題が発生したことを示します|

### <a name="send-email"></a><a name="sendemail"></a> 電子メールの送信
新しいメール メッセージを作成して送信します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|SMTP サーバー|無効|テキスト値||SMTP サーバー アドレス|
|サーバー ポート|有効|数値|25|サーバーに使用するポートです。 一般的に、ポートは 25 です|
|SSL を有効にする|N/A|ブール値|無効|セキュリティで保護された接続を通じてサーバーと通信するかどうかを指定します|
|SMTP サーバーには認証が必要|N/A|ブール値|無効|サーバーが認証を必要とするかどうかを指定します|
|ユーザー名|無効|テキスト値||アクセスするメール アカウントのユーザー名|
|パスワード|無効|暗号化された値||アクセスするメール アカウントのパスワード|
|信頼されていない証明書を受け入れます|N/A|ブール値|無効|信頼されていない証明書を受け入れるかどうかを指定します|
|From|無効|テキスト値||送信者のメール アドレスです|
|送信者の表示名|有効|テキスト値||送信者の表示名です|
|To|無効|テキスト値||受信者の電子メールです。 複数のメールが入力されている場合、アドレスのリストをセミコロンで区切ります|
|CC|有効|テキスト値||CC に含まれる電子メール アドレスです。 複数のメールが入力されている場合、アドレスのリストをセミコロンで区切ります|
|BCC|有効|テキスト値||BCC受信者の電子メールです。 複数のメールが入力されている場合、アドレスのリストをセミコロンで区切ります|
|名前|有効|テキスト値||メールの件名です|
|本体|有効|テキスト値||電子メールの本文|
|本文 は HTML|N/A|ブール値|無効|メールの本文を HTML コードとして解釈するかどうかを指定します|
|添付ファイル|有効|ファイルの一覧||添付ファイル、ファイル、ファイルのリストのフルパスです。 複数のファイルは二重引用符 (") で囲み、スペースで区切ります|


##### <a name="variables-produced"></a>作成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="sendemail_onerror"></a> 例外
|例外|内容|
|-----|-----|
|無効なメール アドレス|指定されたメール アドレスが無効であることを示します|
|メールを送信できませんでした|メールの送信で問題が発生したことを示します|
|添付ファイルが見つかりません|指定された添付ファイルが見つからなかったことを示します|


