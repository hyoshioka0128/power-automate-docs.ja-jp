---
title: ファイル | Microsoft Docs
description: ファイルを使用したアクションについての参考情報
author: mariosleon
ms.service: flow
ms.topic: article
ms.date: 12/02/2020
ms.author: marleon
ms.reviewer: ''
search.app:
- Flow
search.audienceType:
- flowmaker
- enduser
ms.openlocfilehash: 653a61a114ac58ea67f2d3414c98c6822ec5d908
ms.sourcegitcommit: b043b7e8c29afee4f4f25bbf0d5a662d9af9272c
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/09/2020
ms.locfileid: "4711626"
---
# <a name="file"></a>ファイル



ファイルの管理と操作

|<!-- --> |
|-----|
|[ファイルのコピー](#copy)|
|[ファイルの移動](#move)|
|[ファイルの削除](#delete)|
|[ファイルの名前を変更する](#renamefiles)|
|[ファイルからテキストを読み取ります](#readtextfromfile)|
|[テキストをファイルに書き込みます](#writetext)|
|[CSV を読み取ります](#readfromcsvfile)|
|[CSV ファイルに書き込みます](#writetocsvfile)|
|[ファイル パス部分の取得](#getpathpart)|
|[一時ファイルの取得](#gettemppath)|

### <a name="copy-files"></a><a name="copy"></a> ファイルのコピー
1 つまたは複数のファイルを宛先フォルダーにコピーします

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|コピーするファイル|無効|ファイルの一覧||コピーをするファイルです。 これは、ファイルパス、ファイルを含む変数、ファイルのリスト、テキストパス、またはテキスト パスのリストを指定することができます。 「フォルダ内のファイルを取得」アクションを使用して、ファイルのリストを変数に入力します|
|保存先フォルダー|無効|フォルダー||コピーされたファイルの宛先フォルダー|
|ファイルが存在する場合|N/A|何もしない、上書き|何もしない|同じ名前のファイルが宛先フォルダーに既に存在している場合の対応方法を指定します|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|CopiedFiles|ファイルの一覧|コピーされたファイル (ファイルのリスト)|


##### <a name="exceptions"></a><a name="copy_onerror"></a> 例外
|例外|内容|
|-----|-----|
|ソース フォルダーが存在しません|ソース フォルダーが存在しないことを示します|
|宛先フォルダーが存在しません|宛先フォルダーが存在しないことを示します|
|ファイルが見つかりません|ファイルが存在しないことを示します|
|ファイルをコピーできません|ファイルのコピーで問題が発生したことを示します|

### <a name="move-files"></a><a name="move"></a> ファイルの移動
1 つまたは複数のファイルを宛先フォルダーに移動します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|移動するファイル|無効|ファイルの一覧||移動するファイルです。 ここでは、ファイルパス、ファイルを含む変数、ファイルのリスト、テキストパス、またはテキスト パスのリストを指定することができます。 「フォルダ内のファイルを取得」アクションを使用して、ファイルのリストを変数に入力します|
|保存先フォルダー|無効|フォルダー||移動されたファイルの宛先フォルダー|
|ファイルが存在する場合|N/A|何もしない、上書き|何もしない|同じ名前のファイルが宛先フォルダーに既に存在している場合の対応方法を指定します|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|MovedFiles|ファイルの一覧|移動されたファイル (ファイルのリスト)|


##### <a name="exceptions"></a><a name="move_onerror"></a> 例外
|例外|内容|
|-----|-----|
|ソース フォルダーが存在しません|ソース フォルダーが存在しないことを示します|
|宛先フォルダーが存在しません|宛先フォルダーが存在しないことを示します|
|ファイルが見つかりません|ファイルが存在しないことを示します|
|ファイルを移動できません|ファイルの移動で問題が発生したことを示します|

### <a name="delete-files"></a><a name="delete"></a> ファイルの削除
1 つ以上のファイルを削除する

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|削除するファイル|無効|ファイルの一覧||削除するファイルです。 これは、ファイルパス、ファイルを含む変数、ファイルのリスト、テキストパス、またはテキスト パスのリストを指定することができます。 「フォルダ内のファイルを取得」を使用して、変数にファイルのリストを入力します|


##### <a name="variables-produced"></a>生成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="delete_onerror"></a> 例外
|例外|内容|
|-----|-----|
|ファイル パスが存在しません|ファイル パスが存在しないことを示します|
|ファイルが見つかりません|ファイルが存在しないことを示します|
|ファイルを削除できません|ファイルの削除で問題が発生したことを示します|

### <a name="rename-files"></a><a name="renamefiles"></a> ファイルの名前を変更する
1 つまたは複数のファイル名を変更します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|名前を変更するファイル|無効|ファイルの一覧||名称変更するファイルです。 これは、ファイルパス、ファイルを含む変数、ファイルのリスト、テキストパス、またはテキスト パスのリストを指定することができます。 「フォルダ内のファイルを取得」アクションを使用して、ファイルのリストを変数に入力します|
|追加する番号|N/A|ブール値|有効|既存のファイル名または新しい名前に番号を追加するかどうかを指定します|
|名前の変更の方法|N/A|新しい名前の設定、テキストの追加、テキストの削除、テキストの置換、拡張子の変更、日時の追加、順序の作成|新しい名前を設定する|ファイル名の変更方法を指定します|
|新しいファイル名|無効|テキスト値||新しいファイル名|
|新しい拡張子|有効|テキスト値||ファイルの新しい拡張子として追加するテキスト|
|新しいファイル名|無効|テキスト値||新しいファイル名|
|追加する番号|N/A|名前の後、名前の前|操作後の名前|元の名前または新しい名前の前後に番号を追加するかどうかを指定します|
|追加するテキスト|有効|テキスト値||元のファイル名に追加するテキスト|
|削除するテキスト|有効|テキスト値||元のファイル名から削除するテキストです。 この名称変更スキームは、各ファイル名を検索し、名前の中の任意の場所にある入力されたテキストを、それが発生するたびに削除します|
|置換するテキスト|無効|テキスト値||元のファイル名で置き換えるテキストです。 この名称変更スキームは、各ファイル名を検索し、名前の中の任意の場所にある入力されたテキストを、それが発生するたびに置換えます|
|カスタム日時を使用します|N/A|ブール値|無効|カスタム日時を使用するかどうかを指定します|
|追加する日時|N/A|現在の日時、作成時刻、最終アクセス日、最終変更日|現在の日時|ファイル名に追加する日時の値を指定します|
|拡張子を保持する|N/A|ブール値|有効|前の拡張子をファイル名に含めるかどうかを指定します。 ファイルに拡張子を手動で追加するには、このオプションを無効にします|
|置き換え先のテキスト|有効|テキスト値||元のテキストを置き換えるテキスト|
|開始番号|無効|数値||開始番号|
|テキストを追加する|N/A|名前の後、名前の前|操作後の名前|元の名前の前後にテキストを追加するかどうかを指定します|
|カスタムの日時|無効|Datetime||ファイル名に追加する日時|
|増分|無効|数値||開始値をインクリメントする数値|
|日時を追加する|N/A|名前の後、名前の前|操作後の名前|元の名前の前後に日時を追加するかどうかを指定します|
|区切り文字|N/A|なし、スペース、ダッシュ、ピリオド、アンダースコア|スペース|元のファイル名と追加された番号の値を区切るために使用する記号を指定します。区切り記号を使用しないオプションも含みます|
|区切り文字|N/A|なし、スペース、ダッシュ、ピリオド、アンダースコア|スペース|元のファイル名と追加された日時の値を区切るために使用する記号を指定します。区切り記号を使用しないオプションも含みます|
|パディングを使用します|N/A|ブール値|無効|パディングを使用するかどうかを指定します|
|日時の形式|有効|テキスト値|yyyyMMdd|ファイル名に追加する日時の値の形式 (日付 MM/dd/yyyy や、時間 hh: mm: sstt など)|
|各番号の最小長|有効|数値|3|追加される各番号の最小長|
|ファイルが存在する場合|N/A|何もしない、上書き|何もしない|同じ名前のファイルがフォルダーに既に存在している場合の対応方法を指定します|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|RenamedFiles|ファイルの一覧|名前を変更されたファイル (ファイルのリスト)|


##### <a name="exceptions"></a><a name="renamefiles_onerror"></a> 例外
|例外|内容|
|-----|-----|
|ディレクトリが見つかりません|ディレクトリが見つからなかったことを示します|
|ファイルが見つかりません|ファイルが存在しないことを示します|
|ファイル名を変更できません|ファイル名の変更で問題が発生したことを示します|

### <a name="read-text-from-file"></a><a name="readtextfromfile"></a> ファイルからテキストを読み取る
テキスト ファイルの内容を読み取ります

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|ファイル パス|無効|ファイル||読み取るファイル|
|内容の保存方法|N/A|単一のテキスト値、リスト (各リスト アイテム)|単一のテキスト値|テキストの保存方法を指定します。 テキスト全体を単一のテキスト値として保存するには、「単一のテキスト値」を選択します。 「リスト」を選択すると、元のテキストの各行をテキスト項目としてリストに保存することができます|
|エンコード|N/A|既定、ANSI、Unicode、Unicode (ビッグエンディアン)、UTF-8|UTF-8|指定したテキストをテキスト ファイルから読み取るために使うエンコード。|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|FileContents|テキスト値|内容 (テキスト)|
|FileContents|テキスト値の一覧|内容 (テキストのリスト)|


##### <a name="exceptions"></a><a name="readtextfromfile_onerror"></a> 例外
|例外|内容|
|-----|-----|
|ディレクトリが見つかりません|ディレクトリが見つからなかったことを示します|
|ファイルが見つかりません|ファイルが存在しないことを示します|
|ファイルを読み取れませんでした|ファイルの読み取りで問題が発生したことを示します|

### <a name="write-text-to-file"></a><a name="writetext"></a>  テキストをファイルに書き込む
ファイルにテキストを書き込むか、または追加します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|ファイル パス|無効|ファイル||テキストを書き込むファイルです。 ここでは、ファイルパス、ファイルやテキスト パスを含む変数を指定することができます|
|書き込むテキスト|有効|一般の値||指定されたファイルに書き込むテキスト|
|新しい行を追加する|N/A|ブール値|有効|ファイルに書き込むテキスト全体の最後に、新しい行を追加するかどうかを指定します|
|ファイルが存在する場合|N/A|既存の内容を上書きする、内容を追加する|既存の内容を上書きする|既存のコンテンツを上書きするか、既存のコンテンツの最後に追加するかを指定します。 ファイルが存在しない場合、このアクションにより自動的にファイルが作成されます|
|エンコード|N/A|既定、ANSI、Unicode、Unicode (ビッグエンディアン)、UTF-8、Unicode (バイト オーダー マスクなし)、UTF-8 (バイト オーダー マスクなし)|Unicode|指定したテキストをテキスト ファイルに書き込むために使用するエンコード|


##### <a name="variables-produced"></a>生成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="writetext_onerror"></a> 例外
|例外|内容|
|-----|-----|
|ファイルにテキストを書き込めませんでした|ファイルへの書き込みで問題が発生したことを示します|
|ファイルのディレクトリが無効です|ディレクトリが無効であることを示します|

### <a name="read-from-csv-file"></a><a name="readfromcsvfile"></a>CSV を読み取ります
CSV ファイルをデータ テーブルに読み込みます

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|ファイル パス|無効|ファイル||読み取る CSV です。 ここでは、ファイルパス、ファイルやテキスト パスを含む変数を指定することができます|
|エンコード|N/A|UTF-8、Unicode、Unicode (ビッグエンディアン)、UTF-8 (バイト オーダー マークなし)、Unicode (バイト オーダー マークなし)、システム デフォルト、ANSI|UTF-8|指定された CSV ファイルを読み取るために使用するエンコード|
|フィールドのトリミング|N/A|ブール値|有効|抽出されたセルの先頭と末尾にある空白を自動的にトリミングするかどうかを指定します|
|最初の行に列名が含まれています|N/A|ブール値|無効|CSV リソースの最初の行を使用して、結果のデータ テーブル バリアントの列名を設定するかどうかを指定します。 このオプションを有効にすると、名前をデータとしてテーブルに読み込まないようにすることができます。 後続のアクションは、(列番号の代わりに) 列名を使用してデータ テーブルに保持されているデータにアクセスする場合があります|
|列区切り記号|N/A|事前定義、カスタム、固定列幅|定義済み|定義済みの列区切り記号、カスタム列区切り記号、固定列幅のいずれを使用するかを指定します|
|区切り文字|N/A|システムの既定、カンマ、セミコロン、タブ|システムの既定値|CSV ファイルを解析するための列区切り記号|
|カスタム区切り記号|無効|テキスト値||指定された CSV リソースを解析するために使用するカスタムの列区切り記号|
|列の幅を固定する|無効|テキスト値||指定した CSV リソースを解析する際に使用する固定列幅です。 カンマ、スペース、タブや改行で幅を区切る|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|CSVTable|Datatable|CSV ファイルの内容 (データ テーブル)|


##### <a name="exceptions"></a><a name="readfromcsvfile_onerror"></a> 例外
|例外|内容|
|-----|-----|
|CSV の読み取りに失敗しました|CSV ファイルの読み取りで問題が発生したことを示します|

### <a name="write-to-csv-file"></a><a name="writetocsvfile"></a>CSV ファイルに書き込みます
データ テーブル、データ行、またはリストを CSV ファイルに書き込みます

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|書き込む変数|無効|一般の値||対象の CSV ファイルに書き込むデータ テーブル、データ行の変数、またはリスト変数|
|ファイル パス|無効|ファイル||変数をエクスポートする CSV ファイルです。 ここでは、ファイルパス、ファイルやテキスト パスを含む変数を指定することができます|
|エンコード|N/A|UTF-8、Unicode、Unicode (ビッグエンディアン)、UTF-8 (バイト オーダー マークなし)、Unicode (バイト オーダー マークなし)、システム デフォルト、ANSI|UTF-8|指定された CSV ファイルに書き込むために使用するエンコード |
|列名を含めます|N/A|ブール値|無効|指定したバリアントの列名を CSV ファイルの最初の行にするかどうかを指定します。 このオプションは、対象の CSV ファイルが存在しないか、または存在するがテキストが空の場合にのみ有効です|
|ファイルが存在する場合|N/A|既存の内容を上書きする、内容を追加する|既存の内容を上書きする|対象の CSV ファイルがファイル システムに既に存在する場合に必要な動作を指定します|
|区切り文字|N/A|システムの既定、カンマ、セミコロン、タブ|システムの既定値|指定された CSV ファイルで使用する列区切り記号|
|カスタム列区切り記号|無効|テキスト値||CSV ファイルで使用するカスタム列区切り記号|
|カスタム列区切り記号を使用します|N/A|ブール値|無効|カスタム列区切り記号、定義済みの列区切り記号のいずれを使用するかを指定します|


##### <a name="variables-produced"></a>生成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="writetocsvfile_onerror"></a> 例外
|例外|内容|
|-----|-----|
|書き込めませんでした|CSV ファイルへの書き込みで問題が発生したことを示します|

### <a name="get-file-path-part"></a><a name="getpathpart"></a> ファイル パス部分の取得
ファイル パスを表すテキストから、1 つまたは複数の部分 (ディレクトリ、ファイル名、拡張子など) を取得します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|ファイル パス|無効|ファイル||ソースとして使用するファイル パス|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|RootPath|ファイル|ソース ファイルのルート パス|
|ディレクトリ|フォルダー|ソース ファイルのディレクトリ|
|ファイル名|テキスト値|ソース ファイル名|
|FileNameNoExtension|テキスト値|ソース ファイル名 (拡張子なし)|
|FileExtension|テキスト値|ソース ファイルの拡張子 (.docなど)|


##### <a name="exceptions"></a><a name="getpathpart_onerror"></a> 例外
|例外|内容|
|-----|-----|
|ファイル パスが存在しません|ファイル パスが存在しないことを示します|

### <a name="get-temporary-file"></a><a name="gettemppath"></a> 一時ファイルの取得
一意の名前を付けた、空の一時ファイルをディスク上に作成し、ファイル オブジェクトを取得します (これは表現であり、ファイルとそのすべての情報にアクセスできます)

##### <a name="input-parameters"></a>入力パラメーター
- このアクションには入力は必要ありません

##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|TempFile|ファイル|一時ファイル オブジェクト|


##### <a name="exceptions"></a><a name="gettemppath_onerror"></a> 例外
|例外|内容|
|-----|-----|
|一時ファイルを作成できませんでした|一時ファイルの作成で問題が発生したことを示します|


