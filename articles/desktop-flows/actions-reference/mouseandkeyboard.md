---
title: マウスとキーボード | Microsoft Docs
description: マウスとキーボードのアクションについての参考情報
author: mariosleon
ms.service: flow
ms.topic: article
ms.date: 12/02/2020
ms.author: marleon
ms.reviewer: ''
search.app:
- Flow
search.audienceType:
- flowmaker
- enduser
ms.openlocfilehash: 2f12862a59e438f1059b574f1b126a568df81d81
ms.sourcegitcommit: b043b7e8c29afee4f4f25bbf0d5a662d9af9272c
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/09/2020
ms.locfileid: "4711622"
---
# <a name="mouse-and-keyboard"></a>マウスとキーボード



マウスとキーボードのコントロールを取得します

|<!-- --> |
|-----|
|[入力のブロック](#blockinput)|
|[マウスの位置を取得します](#getmouseposition)|
|[マウスの移動](#movemouse)|
|[マウスを画像に移動します](#movemousetoimagebase)|
|[画面上のテキストにマウスを移動する (OCR)](#movemousetotextonscreenwithocraction)|
|[マウス クリックの送信](#sendmouseclick)|
|[キーの送信](#sendkeys)|
|[キーを押す/離す](#pressreleasekey)|
|[キーの状態を設定](#setkeystate)|
|[キーボード識別子を取得する](#getkeyboardlayout)|
|[ショートカット キーを待機する](#waitforshortcutkeyaction)|

### <a name="block-input"></a><a name="blockinput"></a> 入力のブロック
ユーザーのマウスとキーボードの入力をブロックし、フローがユーザーの干渉を受けることなく、マウスとキーボードのアクションを実行できるようにします

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|ブロックする|N/A|ブール値|有効|マウスとキーボードの入力をブロックするかブロック解除するかを指定します|


##### <a name="variables-produced"></a>生成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="blockinput_onerror"></a> 例外
|例外|内容|
|-----|-----|
|非インタラクティブ モードでユーザー入力のブロック/ブロック解除はできません|非インタラクティブ モードでの入力のブロックまたはブロック解除に問題があることを示します|
|入力をブロックまたはブロック解除できませんでした|入力のブロックまたはブロック解除に問題があることを示します|

### <a name="get-mouse-position"></a><a name="getmouseposition"></a> マウスの位置を取得する
画面上でのマウス カーソルの現在の位置を、ピクセル座標で取得します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|相対|N/A|スクリーン、フォアグラウンド ウィンドウ|Screen|画面座標でマウスの位置を取得するか、アクティブ ウィンドウの左上隅に対するマウスの相対位置を取得するかを指定します|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|MousePosX|数値|マウス位置の水平値 (X)|
|MousePosY|数値|マウス位置の垂直値 (Y)|


##### <a name="exceptions"></a><a name="getmouseposition_onerror"></a> 例外
|例外|内容|
|-----|-----|
|非インタラクティブ モードでマウスの位置を取得できません|非インタラクティブ モードでのマウス カーソルの位置の取得で問題が発生したことを示します|

### <a name="move-mouse"></a><a name="movemouse"></a> マウスの移動
指定された位置にマウスを移動します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|位置 X|無効|数値||マウスの移動先の位置の水平値 (X)|
|位置 Y|無効|数値||マウスの移動先の位置の垂直値 (Y)|
|相対|N/A|スクリーン、アクティブ ウィンドウ、現在のマウス位置|Screen|新しいマウスの位置を、画面の左上隅に対する相対値にするか、最もフォアグラウンドにあるウィンドウの左上隅に対する相対値にするか、または現在のマウス位置にするかを指定します。|
|前の位置からマウスを移動します|N/A|インスタント、アニメーションあり (低速)、アニメーションあり (通常速度)、アニメーションあり (高速)|すぐに|マウスの移動方法を指定します|


##### <a name="variables-produced"></a>生成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="movemouse_onerror"></a> 例外
|例外|内容|
|-----|-----|
|非インタラクティブ モードでマウスを移動できません|非インタラクティブ モードでのマウスの移動に問題が発生したことを示します|
|マウスを移動できませんでした|マウスの移動に問題があることを示します|

### <a name="move-mouse-to-image"></a><a name="movemousetoimagebase"></a> マウスを画像に移動する
画面またはフォアグラウンド ウィンドウで見つかった画像にマウスを移動します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|マウスの移動先の画像|無効|イメージの一覧||マウスの移動先の画像の一覧|
|画像の検索先|N/A|スクリーン全体、前景ウィンドウのみ|画面全体|指定したイメージを最前面のウィンドウのみで検索するのか、表示されている画面全体で検索するのかを指定します。 どちらの選択肢を選んだ場合であっても、スクリーンにはっきりと表示されていない場合は、イメージを見つけることはできません|
|検索モード|N/A|スクリーン全体、または前景ウィンドウの検索、スクリーンまたは前景ウィンドウの指定されたサブ領域の検索|画面全体またはフォアグラウンド ウィンドウを検索します|画面 (またはウィンドウ) 全体をスキャンして指定された画像を検索するか、またはそのサブ領域のみを検索するかを指定します|
|X1|有効|数値||検索するサブ領域の開始 X|
|Y1|有効|数値||検索するサブ領域の開始 Y|
|X2|有効|数値||検索するサブ領域の終了 X|
|Y2|有効|数値||検索するサブ領域の終了 Y|
|画像に対するマウスの相対位置|N/A|左上隅、中央上部、右上隅、左中央、中央、右中央、左下隅、中央下、右下隅|中央|マウスの移動先の画像のセクション|
|オフセット X|有効|数値|0|マウスの位置を右にオフセットするピクセル数|
|オフセット Y|有効|数値|0|マウスの位置を下にオフセットするピクセル数|
|許容値|有効|数値|10|最初に選択した画像と比較して、指定した画像がどれだけ異なるかを指定します|
|マウスの移動スタイル|N/A|インスタント、アニメーションあり (低速)、アニメーションあり (通常速度)、アニメーションあり (高速)|すぐに|マウスを前の場所からレコーディングされたルートの開始位置 (またはその最終位置) に移動する、マウスの移動スタイルを指定します|
|数|有効|数値|1|マウスの移動先となる見つかった画像の数|
|失敗タイムアウト|有効|数値|0|失敗タイムアウト (秒)|
|マウスの移動後にクリックを送信します|N/A|ブール値|無効|画像の上にマウスを移動した後で、クリックを送信するかどうかを指定します|
|クリックの種類|N/A|左クリック、右クリック、中クリック|左クリック|画像に送信するマウス クリック|
|クリックするまでの秒数|有効|数値|0|クリックを送信する前に待機する秒数|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|X|数値|画面上でイメージが見つかったポイントの X 座標。 前景ウィンドウでイメージを検索している場合、返される座標はウィンドウの左上隅を基準にしています|
|年|数値|画面上でイメージが見つかったポイントの Y 座標。 前景ウィンドウでイメージを検索している場合、返される座標はウィンドウの左上隅を基準にしています|


##### <a name="exceptions"></a><a name="movemousetoimagebase_onerror"></a> 例外
|例外|内容|
|-----|-----|
|画面で画像が見つかりません|画面で指定された画像が見つからなかったことを示します|
|非インタラクティブ モードでマウスを移動できません|非インタラクティブ モードでのマウスの移動に問題が発生したことを示します|
|マウスを移動できませんでした|マウスの移動に問題があることを示します|
|無効なサブ領域座標|指定されたサブ領域の座標が無効であることを示します|
|画面で十分な数の画像が見つかりません|画面上で、十分な数の指定された画像が見つからなかったことを示します|

### <a name="move-mouse-to-text-on-screen-ocr"></a><a name="movemousetotextonscreenwithocraction"></a>画面上のテキストにマウスを移動する (OCR)
画面またはフォアグラウンド ウィンドウで、OCR を使用して見つかったテキストにマウスを移動します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|OCR エンジン|無効|OCREngineObject||テキストを検索するために使用される OCR エンジン|
|検索するテキスト|無効|テキスト値||マウスの移動先のテキスト|
|正規表現|N/A|ブール値|無効|画面上のテキストを検索するために正規表現を使用するかどうかを指定します|
|数|有効|数値|1|画面での入力テキストの数として使用される正の数値|
|テキストの検索先|N/A|スクリーン全体、前景ウィンドウのみ|画面全体|指定したテキストを最前面のウィンドウのみで探すか、表示されている画面全体で探すかを指定します。 どちらの選択肢を選んでも、画面上にはっきりと表示されていない場合は、テキストを見つけることはできません|
|検索モード|N/A|特定のソース全体、特定のサブ領域のみ、イメージを基準としたサブ領域|指定されたすべてのソース|画面 (またはウィンドウ) 全体をスキャンして指定されたテキストを検索するか、またはそのサブ領域のみを検索するかを指定します|
|画像|無効|イメージの一覧||指定されたテキストをスキャンするサブ領域 (画像の左上隅に対する相対値) を指定する画像|
|X1|有効|数値||指定されたテキストをスキャンするサブ領域の開始 X 座標|
|許容値|有効|数値|10|最初に選択した画像に一致するまで、何回検索を繰り返すかを指定します|
|Y1|有効|数値||指定されたテキストをスキャンするサブ領域の開始 Y 座標|
|X1|有効|数値||指定されたテキストをスキャンする指定された画像に対するサブ領域の開始相対 X 座標|
|X2|有効|数値||指定されたテキストをスキャンするサブ領域の終了 X 座標|
|Y1|有効|数値||指定されたテキストをスキャンする指定された画像に対するサブ領域の開始相対 Y 座標|
|Y2|有効|数値||指定されたテキストをスキャンするサブ領域の終了 Y 座標|
|X2|有効|数値||指定されたテキストをスキャンする指定された画像に対するサブ領域の終了相対 X 座標|
|Y2|有効|数値||指定されたテキストをスキャンする指定された画像に対するサブ領域の終了相対 Y 座標|
|前の位置からマウスを移動します|N/A|インスタント、アニメーションあり (低速)、アニメーションあり (通常速度)、アニメーションあり (高速)|すぐに|マウスを前の位置から最終的な位置に移動するときの移動のスタイル|
|テキストが表示されるまで待機します|N/A|ブール値|無効|画面上またはフォアグラウンド ウィンドウにテキストが表示されていない場合に、待機するかどうかを指定します|
|テキストが次の時間内に表示されない場合には失敗します|有効|数値|10|指定したテキストが表示されるまで待機する秒数|
|マウスの移動後にクリックを送信します|N/A|ブール値|無効|テキストの上にマウスを移動した後で、クリックを送信するかどうかを指定します|
|クリックの種類|N/A|左クリック、右クリック、中クリック|左クリック|テキストに送信するマウス クリックの種類|
|クリック前の待機秒数|有効|数値|1|クリックする前に待機する秒数|
|テキストに対するマウスの相対位置|N/A|左上隅、中央上部、右上隅、左中央、中央、右中央、左下隅、中央下、右下隅|中央|マウスの移動先のテキストのセクションを指定します|
|オフセット X|有効|数値|0|マウスの位置を右にオフセットするピクセル数|
|オフセット Y|有効|数値|0|マウスの位置を下にオフセットするピクセル数|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|LocationOfTextFoundX|数値|画面上でテキストが見つかったポイントの X 座標。 テキストが前景ウィンドウで検索された場合、ウィンドウの左上隅からの相対的な位置になります|
|LocationOfTextFoundY|数値|画面上でテキストが見つかったポイントの Y 座標。 テキストが前景ウィンドウで検索された場合、ウィンドウの左上隅からの相対的な位置になります|
|WidthOfTextFound|数値|テキストが見つかった領域の幅|
|HeightOfTextFound|数値|テキストが見つかった領域の幅|


##### <a name="exceptions"></a><a name="movemousetotextonscreenwithocraction_onerror"></a> 例外
|例外|内容|
|-----|-----|
|画面でテキストが見つかりません|画面で指定されたテキストが見つからなかったことを示します|
|非インタラクティブ モードでマウスを移動できません|非インタラクティブ モードでのマウスの移動に問題が発生したことを示します|
|マウスを移動できませんでした|マウスの移動に問題があることを示します|
|無効なサブ領域座標|指定されたサブ領域の座標が無効であることを示します|
|OCR エンジンを利用できません|指定された OCR エンジンが利用できないことを示します|

### <a name="send-mouse-click"></a><a name="sendmouseclick"></a> マウス クリックの送信
マウス クリック イベントを送信します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|送信するマウス イベント|N/A|左クリック、右クリック、ダブルクリック、左ボタン下、左ボタン上、右ボタン下、右ボタン上|左クリック|送信するマウス イベントの形式を指定します|
|待機|有効|数値|0|マウス イベントを送信するまでの遅延時間 (1/1000 秒単位)|
|マウスの移動|N/A|ブール値|無効|マウスの移動|
|X|無効|数値||マウスの水平位置 (X) のピクセル座標|
|年|無効|数値||マウスの垂直位置 (Y) のピクセル座標|
|相対|N/A|スクリーン、アクティブ ウィンドウ、現在のマウス位置|Screen|新しいマウスの位置を、画面の左上隅に対する相対値にするか、最もフォアグラウンドにあるウィンドウの左上隅に対する相対値にするか、または現在のマウス位置にするかを指定します。|
|マウスの移動スタイル|N/A|インスタント、アニメーションあり (低速)、アニメーションあり (通常速度)、アニメーションあり (高速)|すぐに|マウスを前の場所からレコーディングされたルートの開始位置 (またはその最終位置) に移動する、マウスの移動スタイル|


##### <a name="variables-produced"></a>生成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="sendmouseclick_onerror"></a> 例外
|例外|内容|
|-----|-----|
|非インタラクティブ モードでマウス クリックを送信できません|非インタラクティブ モードでのマウス クリックの送信で問題が発生したことを示します|
|マウス クリックが画面の境界外です|マウスのクリックが画面の境界外であったことを示します|
|マウス クリックを送信できませんでした|マウス クリックの送信で問題が発生したことを示します|

### <a name="send-keys"></a><a name="sendkeys"></a> キーの送信
現在アクティブなアプリケーションにキーを送信します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|送信するテキスト|無効|暗号化された値||アプリケーションに送信するテキスト|
|キー入力の間隔の遅延|有効|数値|10|入力エラーを回避するためのキーストロークの送信間隔の遅延を、ミリ秒単位で指定します|
|テキストをハードウェア キーとして送信します|N/A|ブール値|無効|テキスト全体を送信するときに、キーボード上の実際のキーストロークをエミュレートします|


##### <a name="variables-produced"></a>生成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="sendkeys_onerror"></a> 例外
|例外|内容|
|-----|-----|
|非インタラクティブ モードでキーストロークを送信できません|非インタラクティブ モードでのキーストロークの送信で問題が発生したことを示します|
|送信するテキストは、有効なキーストロークを表していません|指定されたテキストが、有効なキーストロークを表していないことを示します|
|キーストロークを送る宛先のアクティブなアプリケーションがありません|キーストロークを送る宛先のアクティブなアプリケーションがないことを示します|
|キーストロークを送信できませんでした|キーストロークの送信で問題が発生したことを示します|


> [!NOTE]
> キーの送信アクション内で押されている物理キーをシミュレートするには、中括弧 **{}** 記号を使用します。 (例: Enter キーを押下するには **{Enter}** を使用します)。 キーを修飾子として使用するには、中括弧を使用して **{}** 記号 2 つの両方のキーを使用します。 (例: Ctrl + A キーを押下するには **{Control}({A})** を使用します)。 キーの送信アクションには、[仮想キーコード](https://docs.microsoft.com/windows/win32/inputdev/virtual-key-codes)を使用できます

##### <a name="valid-keys"></a>有効なキー
|カテゴリ|キー|
|-----|-----|
|ボタン|LButton、RButton、キャンセル、MButton、XButton1、XButton2|
|キーボード コントロール|戻る、タブ、LineFeed、削除、エンター、リターン、シフトキー、コントロールキー、メニュー、ポーズキー、CapsLock、大文字、エスケープ、スペース、Prior、PageUp、PageDown、Next、End、Home、左、上、右、下、Select、印刷、実行、スナップショット、PrintScreen、挿入、削除、ヘルプ|
|ボタン|HangulMode、HanguelMode、KanaMode、JunjaMode、FinalMode、KanjiMode、HanjaMode|
|IME キー|IMEConvert、IMENonconvert、IMEAccept、IMEAceept、IMEModeChange|
|ブラウザ キー|BrowserSearch、BrowserFavorites、BrowserHome|
|音量キー|VolumeMute、VolumeDown、VolumeUp|
|メディア キー|MediaNextTrack、MediaPreviousTrack、MediaStop、MediaPlayPause|
|ボタン|LaunchMail、SelectMedia、LaunchApplication1、LaunchApplication2|
|OEM キー|OemSemicolon、 Oem1、 Oemplus、 Oemcomma、 OemMinus、 OemPeriod、 Oem2、 OemQuestion、 Oem3、 Oemtilde、 Oem4、 OemOpenBrackets、 OemPipe、 Oem5、 OemCloseBrackets、 Oem6、 OemQuotes、 Oem7、 Oem8、 Oem102、 OemBackslash、 OemClear|
|ボタン|ProcessKey、Packet、Attn、Crsel、Exsel、EraseEof、Play、Zoom、NoName、Pa1|
|ボタン|KeyCodem、Shift、Control、Alt、Modifiers|
|D キー|D0、D1、D2、D3、D4、D5、D6、D7、D8、D9|
|レター |A、B、C、D、E、F、G、H、I、J、K、L、M、N、O、P、Q、R、S、T、U、V、W、X、Y、Z|
|Windows キー|LWin、RWin、アプリ、スリープ|
|テンキー|NumPad0、NumPad1、NumPad2、NumPad3、NumPad4、NumPad5、NumPad6、NumPad7、NumPad8、NumPad9|
|計算キー|乗算、加算、分離、減算、小数、除算|
|ファンクション キー|F1、F2、F3、F4、F5、F6、F7、F8、F9、F10、F11、F12、F13、F14、F15、F16、F17、F18、F19、F20、F21、F22、F23、F24|
|ボタン|NumLock、Scroll、LShiftKey、RShiftKey、LControlKey、RControlKey、LMenu、RMenu、BrowserBack、BrowserForward、BrowserRefresh、BrowserStop|

### <a name="pressrelease-key"></a><a name="pressreleasekey"></a> キーを押す/離す
1 つ以上の修飾キー (Alt、Ctrl、または Shift) を押して保持するか、または離します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|実行するアクション|N/A|押す、離す|押す|このアクションでキーを押すか、または離すかを指定します|
|Ctrl|N/A|ブール値|無効|Ctrl キーを押す/離すかどうかを指定します|
|Alt|N/A|ブール値|無効|Alt キーを押す/離すかどうかを指定します|
|シフト|N/A|ブール値|無効|Shift キーを押す/離すかどうかを指定します|
|Win|N/A|ブール値|無効|Windows キーを押す/離すかどうかを指定します|


##### <a name="variables-produced"></a>生成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="pressreleasekey_onerror"></a> 例外
|例外|内容|
|-----|-----|
|非インタラクティブ モードでキーを押す (または離す) ことができません|非インタラクティブ モードでキーを押すときまたは離すときに問題が発生したことを示します|

### <a name="set-key-state"></a><a name="setkeystate"></a> キーの状態を設定する
CapsLock、NumLock、ScrollLock のキーの状態 (オンまたはオフ) を設定します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|キー|N/A|Caps Lock、Num Lock、Scroll Lock|CapsLock|設定するキーを指定します|
|完了状態|N/A|オフ、オン|次の日付と等しい|キーの状態をオンにするかオフにするかを指定します|


##### <a name="variables-produced"></a>生成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="setkeystate_onerror"></a> 例外
|例外|内容|
|-----|-----|
|非インタラクティブ モードでキーの状態を設定できません|非インタラクティブ モードでのキーの状態の設定に問題が発生したことを示します|

### <a name="get-keyboard-identifier"></a><a name="getkeyboardlayout"></a> キーボードの識別子を取得する
マシンのレジストリからアクティブなキーボード識別子を取得する

##### <a name="input-parameters"></a>入力パラメーター
- このアクションには入力は必要ありません

##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|KeyboardLayoutId|数値|アクティブなキーボード識別子のレジストリ キー|


##### <a name="exceptions"></a><a name="getkeyboardlayout_onerror"></a> 例外
|例外|内容|
|-----|-----|
|キーボード識別子が見つかりませんでした|キーボード識別子を取得する際のエラーを示す|

### <a name="wait-for-shortcut-key"></a><a name="waitforshortcutkeyaction"></a> ショートカット キーを待機する
特定のショートカット キーが押されるまで、フローの実行を一時停止します。 ショートカット キーには、少なくとも 1 つのキーまたはキーと (ctrl、alt、shift) のいずれかを含む必要があります。 複数のショートカット キーを定義するには、これらをコンマで区切ります。

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|ショートカット キー|有効|テキスト値の一覧|Ctrl + A|待機するショートカット キーを指定します。  ショートカット キーには 1 つのキー、または 1 つのキーと (Ctrl、Alt、Shift) を組み合わせて指定します。 複数のショートカットキーのいずれかを待機するには、それらがリストに含まれている必要があります。|
|タイムアウト時にフローの実行を続行する|N/A|ブール値|無効|設定したショートカット キーの待機時間が過ぎた場合、フローの実行を続行するかどうかを指定します|
|次の時間の後に続行します|有効|数値|10|フローの実行を続行するまでの時間 (秒単位)|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|IndexOfShortcutKeyPressed|数値|ショートカット キーがリスト形式の場合の、ショートカット キーのインデックス。|


##### <a name="exceptions"></a><a name="waitforshortcutkeyaction_onerror"></a> 例外
|例外|内容|
|-----|-----|
|ショートカット キーを登録できません|ショートカット キーの登録が失敗したことを示します。|


