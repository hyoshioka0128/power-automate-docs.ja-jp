---
title: Exchange | Microsoft Docs
description: Exchange のアクションについての参考情報
author: mariosleon
ms.service: flow
ms.topic: article
ms.date: 12/02/2020
ms.author: marleon
ms.reviewer: ''
search.app:
- Flow
search.audienceType:
- flowmaker
- enduser
ms.openlocfilehash: 48001c0de93aa71c1b6402cc33d8f3f33aa5c735
ms.sourcegitcommit: b043b7e8c29afee4f4f25bbf0d5a662d9af9272c
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/09/2020
ms.locfileid: "4711627"
---
# <a name="exchange"></a>Exchange



Exchange のメールの送信、受信、管理を自動化します

|<!-- --> |
|-----|
|[Exchange サーバーに接続します](#connecttoexchangeserver)|
|[Exchange メール メッセージを取得します](#retrieveexchangemessages)|
|[Exchange メール メッセージを送信します](#sendmessage)|
|[Exchange メール メッセージを処理します](#processexchangemessages)|

### <a name="connect-to-exchange-server"></a><a name="connecttoexchangeserver"></a> Exchange サーバーに接続する
Exchange サーバーへの新しい接続を開きます

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|Exchange サーバーのバージョン|N/A|Exchange 2010、Exchange 2010 SP1、Exchange 2010 SP2、Exchange 2013、Exchange 2013 SP1|Exchange 2013 SP1|Exchange サーバーのバージョンです|
|接続の種類|N/A|自動検出、Exchange サーバーアドレス|自動検出|Exchange サーバーへの接続方法を指定します|
|サーバー アドレス|無効|テキスト値||Exchange サーバー アドレスです|
|メール アドレス|無効|テキスト値||Exchange アカウント メール アドレス|
|資格情報|N/A|Exchange の既定、ユーザー定義|Exchange の既定値|ユーザーの Exchange 資格情報を入力する方法を指定します|
|ドメイン|有効|テキスト値||Exchange アカウント ドメイン。 ユーザー名からアカウントドメインを抽出するには、このフィールドを空のままにします|
|ユーザー名|無効|テキスト値||Exchange アカウントのユーザー名|
|パスワード|無効|暗号化された値||Exchange アカウントのパスワード|
|タイムアウト|有効|数値|30|接続の確立を待機する時間 (秒) です。この時間内に接続が確立されない場合には、アクションは失敗します|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|ExchangeConnection|Exchange 接続|後の Exchange アクションで使用する特定の Exchange 接続|


##### <a name="exceptions"></a><a name="connecttoexchangeserver_onerror"></a> 例外
|例外|内容|
|-----|-----|
|Exchange サーバーに接続できませんでした|Exchange サーバーへの接続に問題があることを示します|

### <a name="retrieve-exchange-email-messages"></a><a name="retrieveexchangemessages"></a> Exchange メール メッセージの取得
指定された Exchange サーバーからメール メッセージを取得します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|Exchange 接続|無効|Exchange 接続||Exchange の接続です。 「Exchange サーバーへの接続」アクションを使用して Exchange への接続を作成します|
|メールボックスの種類|N/A|個人用、共有|個人用|メール メッセージの取得元のメールボックスの種類です|
|共有メールボックスのアドレス|無効|テキスト値||メール メッセージの取得元の共有メールボックスのアドレスです|
|カスタム フォルダーからメール メッセージを取得します|N/A|ブール値|無効|メール メッセージをカスタム フォルダーから取得するか、定義済みの Exchange フォルダーから取得するかを指定します|
|Exchange フォルダー|N/A|受信トレイ、削除済みアイテム、下書き、送信トレイ、送信済みアイテム、迷惑メール|受信トレイ|メール メッセージの取得元の定義済みの Exchange フォルダー|
|メール フォルダー|有効|テキスト値|受信トレイ|メール メッセージの取得元のメール フォルダーの名前またはパス (例: folder1\folder2) です|
|取得|N/A|すべての電子メール メッセージ、未読の電子メール メッセージのみ、既読の電子メール メッセージのみ|未読のメール メッセージのみ|フォルダー内のすべてのメール メッセージを取得するか、未読のメール メッセージのみを取得するかを指定します|
|開封済みにする|N/A|ブール値|有効|取得したメール メッセージを既読としてマークするか、そのままにするかを指定します|
|送信者が次を含む|有効|テキスト値||メッセージを取得する送信者の完全なメールアドレスです。 この属性を空白のままにしておくと、送信者に関係なくすべてのメッセージを取得することができます|
|宛先が次を含む|有効|テキスト値||受信者の完全な電子メール アドレス (複数の場合はスペースで区切ってください) を取得する電子メール メッセージ。 受信者に関係なくすべての電子メール メッセージを取得するには、この属性を空白のままにしてください|
|件名に次が含まれています|有効|テキスト値||電子メールの件名内で見つけるためのキー フレーズ。 この属性を空白のままにしておくと、件名に関係なくすべての電子メールメッセージを取得できます|
|本文に次が含まれています|有効|テキスト値||電子メールの本文内で見つけるためのキー フレーズ。 この属性を空白のままにしておくと、内容に関係なくすべての電子メールメッセージを取得することができます|
|Attachments|N/A|添付ファイルを保存する、添付ファイルを保存しない|添付ファイルを保存しません|取得したメール メッセージの添付ファイルを保存するかどうかを指定します|
|添付ファイルを次に保存します|無効|フォルダー||添付ファイルを保存するフォルダーです|


##### <a name="variables-produced"></a>生成された変数
|引数|型|内容|
|-----|-----|-----|
|RetrievedEmails|Exchange メール メッセージの一覧|取得して後で処理を行うメール メッセージです。これには Exchange メール メッセージ オブジェクトの一覧が含まれています|


##### <a name="exceptions"></a><a name="retrieveexchangemessages_onerror"></a> 例外
|例外|内容|
|-----|-----|
|添付ファイルを保存できませんでした|添付ファイルを保存するときに問題が発生したことを示します|
|指定されたメール フォルダーが存在しません|指定されたメール フォルダーが存在しないことを示します|
|メール メッセージを取得できませんでした|メール メッセージの取得中に問題が発生したことを示します|

### <a name="send-exchange-email-message"></a><a name="sendmessage"></a> Exchange メール メッセージを送信する
新しいメール メッセージを作成して送信します

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|Exchange 接続|無効|Exchange 接続||Exchange の接続です。 「Exchange サーバーへの接続」アクションを使用して Exchange への接続を作成します|
|From|無効|テキスト値||送信者のメール アドレスです|
|送信者の表示名|有効|テキスト値||送信者の表示名です|
|To|無効|テキスト値||受信者の電子メールです。 複数のメールを入力するには、アドレスをセミコロンで区切ってください|
|CC|有効|テキスト値||CC受信者の電子メールです。 複数のメールを入力するには、アドレスをセミコロンで区切ってください|
|BCC|有効|テキスト値||BCC受信者の電子メールです。 複数のメールを入力するには、アドレスをセミコロンで区切ってください|
|名前|有効|テキスト値||メールの件名です|
|本体|有効|テキスト値||本文のテキストです|
|本文 は HTML です|N/A|ブール値|無効|メールの本文を HTML コードとして解釈するかどうかを指定します|
|添付ファイル|有効|ファイルの一覧||添付ファイルのフル パスです。 ファイルが複数の場合は、二重引用符 (") で囲み、空白文字で区切ります|


##### <a name="variables-produced"></a>生成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="sendmessage_onerror"></a> 例外
|例外|内容|
|-----|-----|
|添付ファイルが見つかりません|指定された添付ファイルが存在しないことを示します|
|メールを送信できませんでした|メールの送信で問題が発生したことを示します|

### <a name="process-exchange-email-messages"></a><a name="processexchangemessages"></a> Exchange メール メッセージの処理
メール メッセージ (またはメール メッセージの一覧) を移動、削除、または未読としてマークします

##### <a name="input-parameters"></a>入力パラメーター
|引数|省略可能|承認|既定|内容|
|-----|-----|-----|-----|-----|
|Exchange 接続|無効|Exchange 接続||Exchange の接続です。 「Exchange サーバーへの接続」アクションを使用して Exchange への接続を作成します|
|処理するメール メッセージ|無効|Exchange メール メッセージの一覧||処理するメール メッセージです。 「Exchange 電子メールメッセージの取得」アクションによって生成された変数を使用します|
|操作|N/A|サーバーのメール メッセージの削除、メールメッセージを未読としてマーク、メール メッセージをメール フォルダに移動|メール メッセージをメール フォルダーへ移動します|指定されたメール メッセージに対して、どの操作を実行するかを指定します|
|メールボックスの種類|N/A|個人用、共有|個人用|メール メッセージの取得元のメールボックスの種類です|
|共有メールボックスのアドレス|無効|テキスト値||メール メッセージの取得元の共有メールボックスのアドレスです|
|カスタム フォルダーに移動します|N/A|ブール値|無効|メール メッセージをカスタム フォルダーに移動するか、定義済みの Exchange フォルダーに移動するかを指定します|
|Exchange フォルダー|N/A|受信トレイ、削除済みアイテム、下書き、送信トレイ、送信済みアイテム、迷惑メール|受信トレイ|メール メッセージの移動元の定義済みの Exchange フォルダー|
|メール フォルダー|有効|テキスト値|受信トレイ|メール メッセージの移動先のメール フォルダーの名前またはパス (例: folder1\folder2) です|


##### <a name="variables-produced"></a>生成された変数
- このアクションは変数を生成しません

##### <a name="exceptions"></a><a name="processexchangemessages_onerror"></a> 例外
|例外|内容|
|-----|-----|
|指定されたメール フォルダーが存在しません|指定されたメール フォルダーが存在しないことを示します|
|メール メッセージを処理できませんでした|指定されたメール メッセージの処理中に問題が発生したことを示します|


