---
title: Power Apps のワークフローのためのアクションを構成する | MicrosoftDocs
ms.custom: ''
ms.date: 06/27/2018
ms.reviewer: ''
ms.service: flow
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
applies_to:
- Dynamics 365 (online)
- Dynamics 365 Version 9.x
- Power Apps
author: Mattp123
ms.assetid: 6dbc0f10-7ac5-4685-ab74-22d24bf7102d
caps.latest.revision: 19
ms.author: matp
manager: kvivek
search.app:
- Flow
search.audienceType:
- flowmaker
- enduser
ms.openlocfilehash: cba86e3e10591bb5e1ac36a68840ff7954146329
ms.sourcegitcommit: d336e5ffb6cf07e5c8fefe19a87dd7668db9e074
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/26/2020
ms.locfileid: "3296968"
---
# <a name="configure-custom-actions-from-a-workflow"></a>ワークフローからユーザー定義アクションを構成


コードを作成せずにワークフローからカスタム アクションを有効にすることができます。 詳しくは、「[ワークフローからカスタム アクションを呼び出す](invoke-custom-actions-workflow-dialog.md)」をご覧ください。  
  
 開発者がコードで使用できるようにアクションを作成したり、以前に定義されたアクションを編集することが必要になったりすることもあります。 ワークフロー プロセスのように、次のことを考慮します。  
  
-   アクションを何を実行する必要がありますか？  
  
-   どのような条件の下でアクションを実行する必要がありますか？  
  
 
ワークフロー プロセスとは異なり、以下のオプションを設定する必要はありません。  
  
- **開始時期**: アクションに対して生成されたメッセージをコードが呼び出すと、アクションが開始されます。  
  
- **スコープ**: アクションは、常に呼び出し元ユーザーのコンテキストで実行されます。  
  
- **バックグラウンドで実行**: アクションは常にリアルタイム ワークフローになります。  
  
また、アクションにはワークフロー プロセスにないものがあります。それは入力と出力の引数です。 詳しくは、「[プロセスの引数を定義する](configure-actions.md#BKMK_DefineProcessArgs)」をご覧ください。  
  
<a name="create"></a>   
## <a name="create-an-action"></a>アクションを作成する  
  
> [!IMPORTANT]
>  ソリューションの一部として配布するアクションを作成する場合には、そのソリューションのコンテキストでアクションを作成します。 **[[設定]](/powerapps/maker/model-driven-apps/advanced-navigation#settings)** > **[ソリューション]** に移動し、そのアクションを含めるアンマネージド ソリューションを探します。 次に、メニュー バーで、**新規** > **プロセス**を選択します。 これにより、アクション名に関連付けられているカスタマイズ接頭辞が、ソリューション内の他のコンポーネントと確実に一致するようになります。 アクションを作成したら、接頭辞は変更できません。  
  
 ワークフロー プロセスのように、アクションの**プロセスの作成**ダイアログ ボックスには以下のプロパティがあります。  
  
 **プロセス名**  
 プロセスの名前を入力した後、プロセス名からスペース文字または特殊文字を削除することによって、一意の名前が作成されます。  
  
 **カテゴリ**  
 このプロパティは、これがアクション プロセスであることを確立します。 いったんエンティティを保存したら、これを変更できません。  
  
 **エンティティ**  
 アクション プロセスでは、そのほかの種類のプロセスと同様に、ワークフローにコンテキストを提供するエンティティを選択することができますが、**なし (グローバル)** を選択することもできます。 アクションが特定のエンティティのコンテキストを必要としない場合は、これを使用します。 いったんエンティティを保存したら、これを変更できません。  
  
 **種類**  
 このプロパティを使用して、アクションを新規に最初から作成するか、または既存のテンプレートから始めるかを選択します。  
  
<a name="edit"></a>   
## <a name="edit-an-action"></a>アクションの編集  
 プロセスを編集するには、その前にプロセスを非アクティブ化する必要があります。  
  
 アンマネージド ソリューションの一部として作成されたアクション、または組織にインストールされているソリューションに含まれているアクションを編集できます。 ソリューションが管理ソリューションである場合、そのソリューションは編集できない場合があります。 ソリューション発行者は、マネージド ソリューションとともにインストールされたアクションを編集できないように、管理プロパティを編集することもできます。  
  
 アクションが保存されるとき、[一意の名前] がプロセス名に基づいて生成されます。 この一意の名前には、ソリューション発行者からのカスタマイズ接頭辞が付加されています。 これは、開発者がコード内で使用するメッセージの名前です。  
  
 アクションを編集するとき、次のオプションがあります。  
  
 **プロセス名**  
 プロセスが作成され、一意の名前がプロセス名から生成されると、プロセス名を編集できます。 個別のプロセスを特定しやすくする命名規則を適用したいことがあるでしょう。  
  
 **一意の名前**  
 アクションが保存されるとき、[一意の名前] がプロセス名に基づいて生成されます。 この一意の名前には、ソリューション発行者からのカスタマイズ接頭辞が付加されています。 これは、開発者がコード内で使用するメッセージの名前です。 プロセスがアクティブ化され、この名前を使用してアクションを呼び出すようにコードが用意されている場合は、この一意の名前を変更しないでください。  
  
> [!IMPORTANT]
>  アクションがアクティブ化され、一意の名前を使用するコードが作成された後は、一意の名前は、その名前を参照するコードを変更しないかぎり変更はできません。  
  
 **ロールバックを有効にする**  
 通常、トランザクションをサポートするプロセスは、トランザクションのどの部分でも失敗すると、操作全体を "元に戻します" (またはロールバックします)。 これには、いくつかの例外があります。 アクションによって開始されるコード内で開発者が行う可能性のある一部のアクションは、トランザクションをサポートしないことがあります。 たとえば、コードが、トランザクションのスコープ外の他のシステムでアクションを実行する場合です。 これらは、アプリで実行しているアクションによってロールバックできません。 プラットフォームの一部のメッセージは、トランザクションをサポートしません。 しかし、アクションのユーザー インターフェイスだけで実行できるすべてが、トランザクションをサポートします。 リアルタイム ワークフローの一部であるすべてのアクションはイン トランザクションとみなされますが、アクションでは、トランザクションから抜け出ることを選択することもできます。  
  
 アクションがイン トランザクションであるかどうかを決定するためにこのメッセージを使用する開発者に相談する必要があります。 通常、業務プロセスによって実行されるアクションがすべて完了しなければアクションが意味をなさない場合、アクションはイン トランザクションである必要があります。 標準的な例が、2 つの銀行口座間での資金の転送です。 1 つの口座から資金を引き出す場合、もう 1 つの口座にその資金を預ける必要があります。 どちらが失敗した場合、両方が失敗する必要があります。  
  
> [!NOTE]
>  ユーザー定義アクションをワークフロー内から直接実行した場合、ロールバックを有効にできません。 Power Apps web サービス メッセージによってアクションが呼び出される場合はロールバックを有効にできます。  
  
 **次の種類としてアクティブ化:**  
 すべてのプロセスと同様に、プロセスをテンプレートとしてアクティブ化し、同様のパターンに従ったプロセスの高度な開始点として使用できます。  
  
 **プロセスの引数の定義**  
 ここでは、アクションが開始時に予期するデータと、アクションから渡されるデータを指定します。 詳しくは、「[プロセスの引数を定義する](configure-actions.md#BKMK_DefineProcessArgs)」をご覧ください。  
  
 **ステージ、条件、およびアクションの追加**  
 他のプロセスと同様に、実行するアクションと、それをいつ実行するかを指定します。 詳しくは、[ステージ、条件、アクションの追加](configure-actions.md#BKMK_AddStagesConditionsAndActions)に関するセクションをご覧ください。

<a name="BKMK_DefineProcessArgs"></a>   
### <a name="define-process-arguments"></a>プロセスの引数を定義する  
 開発者はメッセージを使用するときは、メッセージに何らかのデータを渡し、そのデータで開始する場合があります。 たとえば、サポート案件レコードを新規に作成する場合、入力引数として渡されるサポート案件のタイトルの値を使用する場合があります。  
  
 開発者は、メッセージが完成すると、メッセージによって変更または生成された一部のデータを、コード内の別の操作へ渡すことが必要な場合があります。 このデータは出力引数です。  
  
 入力引数と出力引数の両方に、名前およびタイプと、引数が常に必須かどうかに関する情報を必要としています。 また、説明を与えることもできます。  
  
 メッセージ名とすべてのプロセス引数に関する情報が、メッセージの "特徴" を表します。 アクションがアクティブ化され、コードで使用されるようになった後、そのシグネチャは変更できません。 このシグネチャが変更されると、そのメッセージを使用するすべてのコードは失敗します。 これに対しての唯一の例外は、必ずしも必須でないようにパラメーターのいずれかを変更する場合です。  
  
 引数は順序ではなく名前で識別されるので、引数を並べ替えたり、上または下に移動して引数の順序を変更できます。 また、説明の変更によって、そのメッセージを使用するコードが壊されることはありません。  
  
#### <a name="action-process-argument-types"></a>アクション プロセスの引数の種類  
 次の表は、アクション プロセスの引数の種類について説明しています。  
  
|種類​​|内容|  
|----------|-----------------|  
|Boolean|`true` または `false` の値。|  
|日時|日付と時刻の情報を格納する値。|  
|小数|小数点以下の精度の数値。 精度が非常に重要な場合に使用します。|  
|エンティティ|指定したエンティティのレコード。 Entity を選択したとき、ドロップダウンが有効になり、エンティティの種類を選択できます。|  
|エンティティ コレクション|エンティティ レコードのコレクションです。|  
|エンティティ参照|エンティティ レコードを一意に識別する、エンティティ レコードの名前、ID、および種類を含むオブジェクト。 EntityReference を選択したとき、ドロップダウンが有効になり、エンティティの種類を選択できます。|  
|浮動小数|小数点以下の精度の数値。 データが完全に正確ではない測定に由来するときに使用されます。|  
|Integer|整数。|  
|金額|金額のデータを保存する値。|  
|候補リスト|OptionSet 属性のオプションを表す値。|  
|文字列|テキスト値。|  
  
> [!NOTE]
> **EntityCollection** 引数の値は、条件またはアクションのユーザー インターフェイスでは設定できません。 これらは、開発者がカスタム コードで使用するために提供されます。 詳しくは、「[独自のアクションの作成](https://docs.microsoft.com/dynamics365/customer-engagement/developer/create-own-actions)」をご覧ください。 
  
<a name="BKMK_AddStagesConditionsAndActions"></a>   
### <a name="add-stages-and-steps"></a>ステージとステップを追加する  
 アクションは、リアルタイム ワークフローにとても良く似たプロセスの種類です。 リアルタイム ワークフローで使用できるすべての手順は、アクションで使用できます。 リアルタイム ワークフローとアクションの両方に使用できるステップの詳細については、「[ワークフローのステージとステップ](configure-workflow-steps.md)」を参照してください。  
  
 リアルタイムのワークフローで使用できる手順に加えて、アクションには**値の割り当て**ステップがあります。   アクションでは、これらは出力引数を設定するためにのみ使用できます。 フォーム アシスタントを使用して、出力引数に特定の値を設定することができます。または、アクションを実行した対象のレコード、そのレコードに多対一リレーションシップで関連するレコード、前のステップで作成されたレコードの値や、プロセスそのものに含まれる値を設定する方がよく行われます。  
  
## <a name="next-steps"></a>次のステップ  
 [アクション](actions.md)  

 [ワークフローからのユーザー定義アクションの呼び出し](invoke-custom-actions-workflow-dialog.md)   
 [リアルタイム ワークフローとアクションを監視する](monitor-manage-processes.md#BKMK_MonitorSyncWorkflows)
 
 
